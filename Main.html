<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YouTubeãƒ¡ãƒ¢</title>
  <style>
    body {
      display: flex;
      font-family: Arial, sans-serif;
      margin: 0;
    }
    #sidebar {
      width: 20%;
      background: #f4f4f4;
      padding: 10px;
      border-right: 1px solid #ccc;
      overflow-y: auto;
    }
    #content {
      flex-grow: 1;
      padding: 10px;
    }
    .folder {
      cursor: pointer;
      margin-bottom: 10px;
      padding-left: 10px;
    }
    .folder.active {
      background-color: #d1e7dd; /* é¸æŠã•ã‚ŒãŸä¸­åˆ†é¡ã‚’è‰²åˆ†ã‘ */
      font-weight: bold;
    }
    .video {
      margin-bottom: 15px;
      padding: 10px 0;
      border-bottom: 1px solid #ccc; /* ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ãƒ¼ */
    }
    iframe {
      width: 100%;
      max-width: 600px;
      height: 315px;
      border: none;
    }
  </style>
</head>
<body>
  <div id="sidebar"></div>
  <div id="content"></div>

  <script>
    let originalData; // åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹å¤‰æ•°
    let currentFolder; // ç¾åœ¨é¸ã°ã‚Œã¦ã„ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã‚’è¨˜éŒ²

    async function loadCSV() {
      const response = await fetch('videos.csv');
      const csvText = await response.text();
      const rows = csvText.trim().split('\n');
      const headers = rows.shift().split(',');

      originalData = rows.map(row => {
        const values = row.split(',');
        return headers.reduce((acc, header, i) => {
          acc[header] = values[i];
          return acc;
        }, {});
      });

      generateGenreSidebar(originalData);
    }

    function generateGenreSidebar(data) {
      const genres = [...new Set(data.map(item => item['ã‚¸ãƒ£ãƒ³ãƒ«']))];
      const sidebar = document.getElementById('sidebar');
      sidebar.innerHTML = ''; // ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ
      const content = document.getElementById('content');
      content.innerHTML = '<p>ã‚¸ãƒ£ãƒ³ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</p>'; // åˆæœŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

      genres.forEach(genre => {
        const folderDiv = document.createElement('div');
        folderDiv.className = 'folder';
        folderDiv.textContent = `ğŸ“ ${genre}`;
        folderDiv.onclick = () => showSubcategories(genre, data);
        sidebar.appendChild(folderDiv);
      });
    }

    function showSubcategories(genre, data) {
      const sidebar = document.getElementById('sidebar');
      const content = document.getElementById('content');
      sidebar.innerHTML = ''; // ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ
      content.innerHTML = ''; // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒªã‚»ãƒƒãƒˆ

      const filteredData = data.filter(item => item['ã‚¸ãƒ£ãƒ³ãƒ«'] === genre);
      const subcategories = [...new Set(filteredData.map(item => item['ä¸­åˆ†é¡']).filter(sub => sub))]; // ä¸­åˆ†é¡ãŒç©ºã¯é™¤å¤–

      // ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«æˆ»ã‚‹ãƒœã‚¿ãƒ³
      const backDiv = document.createElement('div');
      backDiv.className = 'folder';
      backDiv.textContent = 'ğŸ”™ æˆ»ã‚‹';
      backDiv.onclick = () => generateGenreSidebar(originalData); // åˆæœŸçŠ¶æ…‹ã«æˆ»ã‚‹
      sidebar.appendChild(backDiv);

      // ä¸­åˆ†é¡ãƒ•ã‚©ãƒ«ãƒ€ã‚’è¿½åŠ 
      subcategories.forEach((subcategory, index) => {
        const subFolderDiv = document.createElement('div');
        subFolderDiv.className = 'folder';
        subFolderDiv.textContent = `ğŸ“‚ ${subcategory}`;
        subFolderDiv.onclick = () => {
          highlightActiveFolder(subFolderDiv); // é¸æŠã•ã‚ŒãŸãƒ•ã‚©ãƒ«ãƒ€ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
          showVideos(genre, subcategory, data);
        };
        sidebar.appendChild(subFolderDiv);

        // æœ€åˆã®ä¸­åˆ†é¡ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¡¨ç¤º
        if (index === 0) {
          highlightActiveFolder(subFolderDiv); // æœ€åˆã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆé¸æŠ
          showVideos(genre, subcategory, data);
        }
      });
    }

    function showVideos(genre, subcategory, data) {
      const content = document.getElementById('content');
      content.innerHTML = ''; // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒªã‚»ãƒƒãƒˆ

      const filteredVideos = data.filter(item => item['ã‚¸ãƒ£ãƒ³ãƒ«'] === genre && item['ä¸­åˆ†é¡'] === subcategory);

      filteredVideos.forEach(video => {
        const videoDiv = document.createElement('div');
        videoDiv.className = 'video';

        // å‹•ç”»ã‚¿ã‚¤ãƒˆãƒ«ã¨åŸ‹ã‚è¾¼ã¿å‹•ç”»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã€URLã‚’ç›´æ¥è¡¨ç¤º
        videoDiv.innerHTML = `
          <h3>${video['ã‚¿ã‚¤ãƒˆãƒ«']}</h3>
          <iframe src="${video['URL'].replace('watch?v=', 'embed/')}" allowfullscreen></iframe>
          <p>${video['URL']}</p>
        `;
        content.appendChild(videoDiv);
      });
    }

    function highlightActiveFolder(folderDiv) {
      // ä»¥å‰é¸ã°ã‚Œã¦ã„ãŸãƒ•ã‚©ãƒ«ãƒ€ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ãƒªã‚»ãƒƒãƒˆ
      if (currentFolder) {
        currentFolder.classList.remove('active');
      }

      // ç¾åœ¨ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’é¸æŠçŠ¶æ…‹ã«ã™ã‚‹
      folderDiv.classList.add('active');
      currentFolder = folderDiv;
    }

    loadCSV();
  </script>
</body>
</html>
